// prisma/schema.prisma - Modelo de datos normalizado (3NF)

datasource db {
  provider = "sqlite"  // Solo provider â€“ URL gestionada por prisma.config.ts (Prisma 7)
}

model Vigilador {
  id           String    @id @default(uuid())
  nombre       String
  legajo       Int       @unique
  ultimoPunto  Int       @default(0)
  rondaActiva  Boolean   @default(false)
  registros    Registro[]

  @@map("vigilador")
}

model Punto {
  id        Int       @id
  nombre    String
  geo       Json?
  registros Registro[]

  @@map("punto")
}

model Registro {
  id              String    @id @default(uuid())
  vigiladorId     String
  puntoId         Int
  timestamp       DateTime  @default(now())
  geolocalizacion Json?
  novedades       String?

  vigilador       Vigilador @relation(fields: [vigiladorId], references: [id])
  punto           Punto     @relation(fields: [puntoId], references: [id])

  @@index([vigiladorId, timestamp])
  @@map("registro")
}