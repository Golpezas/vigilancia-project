// prisma/schema.prisma - Modelo de datos normalizado (3NF) para Prisma 5.22.0 + SQLite

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"  // ← PostgreSQL (Railway)
  url      = env("DATABASE_URL")
}

model Vigilador {
  id           String    @id @default(uuid())
  nombre       String
  legajo       Int       @unique
  ultimoPunto  Int       @default(0)
  rondaActiva  Boolean   @default(false)
  registros    Registro[]

  @@map("vigilador")
}

model Punto {
  id        Int       @id
  nombre    String
  geo       String?   // ← String simple (SQLite almacena como TEXT)
  registros Registro[]

  @@map("punto")
}

model Registro {
  id              String    @id @default(uuid())
  vigiladorId     String
  puntoId         Int
  timestamp       DateTime  @default(now())
  geolocalizacion String?   // ← String simple (SQLite almacena como TEXT)
  novedades       String?

  vigilador       Vigilador @relation(fields: [vigiladorId], references: [id])
  punto           Punto     @relation(fields: [puntoId], references: [id])

  @@index([vigiladorId, timestamp])
  @@map("registro")
}